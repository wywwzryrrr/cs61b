# Gitlet Design Document

## Gitlet: A Git-like Version Control System built from scratch in Java

**Name**: zng.xee

## Classes and Data Structures

### Commit
Represents a Commit.

#### Fields

1. `String message`: The message that user input when committing.
2. `String timestamp`: The timestamp when committing a file, generated by a helper method.
3. `Stirng parent`: The parent commitUID.
4. `String secondParent`: The second parent commitUID.
5. `TreeMap<String, String> blob`: The snapshots of files of this commit. The keys are files in CWD with absolute path. The values are blobs in BLOBS_DIR.
6. `String UID`: The SHA-1 id of this commit


### Blob

#### Fields

1. `String content`: `Utils.readContentAsString(file)`
2. `String UID`: `Utils.sha1(content)`


### HelperMethods

All the helper methods used in Commands


### Commands

#### Core features

1. `init`: initialize gitlet repository.
2. `commit [message]`: to make a commit.
3. `add [filename]`: add a copy of file to staging area.
4. `rm [filename]`: add a copy of file to stage for removal, and clear the file in stage for addition if it exists.
5. `log`: print the commit UID, message and timestamp chronologically.
6. `global log`: like log, but the order is not considered.
7. `find [message]`: prints out the ids of all commits that have the given commit message, one per line.
8. `branch [branchname]`: create a new branch with the given name.
9. `rmbranch [branchname]`: remove the branch with the given name.
10. `status`: displays what branches currently exist, and marks the current branch with a *. Also displays what files have been staged for addition or removal.
11. `checkout`:  has different functions depending user's input.
+ `checkoutFile [filename]`: change the file with the given filename to the version in head commit.
+ `checkoutCommitFile [commitUID, filename]`: change the file with the given filename to the version in the commit of given commitUID.
+ `checkoutBranch [branchname]`: change the CWD to the given branch's version.
12. `reset [commitUID]`: checkout all the file tracked by the given commitUID.
13. `merge [branchname]`: merge the files in two branches according to different situations.


## Persistence
```
CWD (dir)
 └── .gitlet/ (dir)
      ├── HEAD (file)
      ├── refs/ (dir)
      │   └── heads/ (dir)
      │       └── master (file)
      ├── blobs/ (dir)
      ├── commits/ (dir)
      └── stage/ (dir)
          ├── add (dir)
          └── remove (dir)
```

+ `HEAD` file: stores the current branch's path.
+ `heads` directory in `refs` : stores different branch; name is branch name, content is the commit id on the tip of the branch.
+ `blobs` directory: stores all Blob objects, name is sha-1 UID according to a file's content.
+ `commits` directory: stores all commits, name is commitUID, content is a TreeMap.
+ `stage` directory: staging area contains `add` and `remove`, witch represent stage for addition and stage for removal respectively.


## Design and implementation Detail
1. `Commit`: 
